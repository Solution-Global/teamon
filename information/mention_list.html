<div class="ibox nopadding" style="height: 100%;">
  <div class="ibox-title">
    <h5 class="title"></h5>
    <div class="ibox-tools">
      <a class="aside-close-link"><i class="fa fa-times"></i></a>
    </div>
  </div>
  <div class="ibox-content nopadding information-list mention-list">
    <ul>
      <script id="mention-template" type="text/template">
        <li>
          <div class="img-icon">
            <img alt="{{imgAlt}}" class="img-circle" src="{{img}}">
          </div>
          <div class="mention-message">
            <div>
              <span class="right">
                <a class="channel-link" href="#" data-chatid="{{chatId}}"><h3>{{topic}}</h3></a>
              </span>
            </div>
            <div>
              <span>
                <a class="about-user" href="#" data-emplid="{{senderId}}">{{sender}}</a> - {{time}}
              </span>
            </div>
            <div>
              <span class="message-content">
                {{{msgText}}}
              </span>
            </div>
          </div>
        </li>
      </script>
      <script id="mention-dateline-template" type="text/template">
        <li>
          <h4>{{date}}</h4>
        </li>
      </script>
    </ul>
  </div>
</div>
<script>
$(document).ready(function() {

  var $informationSec = $("#information-section");
  // $informationSec.find(".mention-list").mCustomScrollbar({
  //   axis:"y"
  // });

  var mentionTemplate = $('#mention-template').html();
  var mentionDateLineTemplate = $('#mention-dateline-template').html();
  var $title = $informationSec.find(".title");
  var $mentionArea = $informationSec.find(".mention-list ul");

  var params = {
    "teamId" : loginInfo.teamId,
    "emplId": loginInfo.emplId
  };

  $informationSec.on("click", ".channel-link", function(){
    var topic = $(this).find("h3").html();
    var chatId = $(this).data("chatid");
    var $targetObj = getSingleChattingContext(topic);
    if($targetObj) {
      activeChatView($targetObj, false);

      var $chatSec = $("#chat-section");
      var $contentArea = $chatSec.find(".content_area");

      $contentArea.mCustomScrollbar("scrollTo", "#chat-" + chatId);
      $contentArea.find("#chat-" + chatId).css("border-radius", "3px");
      $contentArea.find("#chat-" + chatId).addClass("animated message-shake");
    }
  });

  restResource.chat.getMentionList(params, function(data) {
    if (data) {
      var messages = [];
      $.each(data, function(idx, row) {
        var formattingRow =  dispalyMessageFormat(row);
        formattingRow.topic = row.topic;
        messages.push(formattingRow);
      });

      $title.html("Mention For " + loginInfo.name + ".");
      for (var key = 0; key < messages.length; key++) {
        if(key === 0) {
          $mentionArea.append(Mustache.render(mentionDateLineTemplate, {"date" : messages[key].date}));
        }
        if(messages[key - 1] && messages[key - 1].date != messages[key].date) {
          $mentionArea.append(Mustache.render(mentionDateLineTemplate, {"date" : messages[key].date}));
        }
        $mentionArea.append(Mustache.render(mentionTemplate, messages[key]));
      }
    }
  });

  $informationSec.find(".mention-list").mCustomScrollbar({
    axis:"y",
    theme:"inset-2-dark"
  });
});
</script>
